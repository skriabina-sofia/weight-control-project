# ![#1589F0](https://placehold.co/15x15/1589F0/1589F0.png) Цель проекта

- Комплексно проанализировать влияние поведенческих и физиологических факторов на изменение веса участников эксперимента по контролю массы тела, выявить закономерности в данных и определить ключевые предикторы успешного снижения веса.

## Основные задачи

- Выяснить, какие поведенческие и физиологические факторы (калорийность, активность, стресс, сон, пол, вес и др.) влияют на изменение веса участников в эксперименте по контролю массы тела.
- Проверить, как профицит/дефицит калорий, длительность участия и активность связаны с успешностью снижения веса.
- Провести корреляционный анализ для:
  - выявления взаимосвязей между количественными признаками (калорийность, BMR, активность, стресс и др.),
  - определения признаков, положительно или отрицательно связанных с итоговым и изменённым весом,
  - оценки степени зависимости между переменными для формирования гипотез и отбора признаков в моделях.
- Провести кластерный анализ участников, чтобы выделить группы с различными паттернами поведения и результатами, и на основе кластеров сформулировать рекомендации.
- Найти ключевые признаки, оказывающие наибольшее влияние на изменение веса, и определить, какие признаки не играют значимой роли.


## Исходные датасеты

Проект использует два CSV-файла:

- participants.csv — содержит персональные и физиологические данные участников:
  - Participant ID, Age, Gender, Current Weight (lbs), BMR (Calories) и др.
- experiments.csv — содержит данные об участии в эксперименте:
  - Participant ID, Daily Calories Consumed, Weight Change (lbs), Duration (weeks) и т.д.

Датасеты объединяются по полю Participant ID в итоговый датафрейм new, содержащий полную информацию об участниках и эксперименте.


## Целевая переменная

- Final Weight (lbs) — итоговый вес участника после завершения эксперимента.
- Используется в качестве целевой переменной как в линейной регрессии, так и в модели CatBoost.


## Предикторы, использованные в линейной регрессии

PythonX = new_encoded[['Current Weight (lbs)', 'Daily Calories Consumed']]
Используются только два предиктора:

- Current Weight (lbs) – исходный вес  
- Daily Calories Consumed – среднее ежедневное потребление калорий

Простая модель, проверяющая влияние двух основных факторов на финальный вес.


## Предикторы, использованные в модели CatBoost

В модели CatBoost использовались расширенные предикторы, в том числе:

- Current Weight (lbs)
- Daily Calories Consumed
- BMR (Calories)
- Daily Caloric Surplus/Deficit
- Duration (weeks)

А также закодированные категориальные признаки:

- Gender_M
- Sleep Quality_*
- Stress Level_*

Включение большего количества переменных позволило модели лучше захватывать поведенческие и физиологические паттерны.


## Используемые методы

- Предобработка данных
  - Проверка на пропуски и дубликаты
  - Кодирование категориальных переменных (OneHotEncoding)

- Объединение данных (merge)
  - Слияние таблиц participants и experiments по Participant ID

- Корреляционный анализ (.corr())
  - Оценка линейных зависимостей между признаками и целевыми переменными

- Линейная регрессия (LinearRegression)
  - Простая модель для анализа влияния базовых признаков

- Регуляризация
  - Модели Ridge, Lasso, ElasticNet с подбором гиперпараметров через Optuna

- CatBoostRegressor
  - Градиентный бустинг на основе деревьев решений
  - Оптимизация параметров с использованием Optuna
  - Анализ важности признаков (Feature Importance)

- Кластеризация (KMeans)
  - Метод локтя для определения оптимального числа кластеров
  - PCA для визуализации кластеров
  - Анализ различий по характеристикам и поведению внутри кластеров
